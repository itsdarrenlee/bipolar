language: cpp

os: osx

# Travis' Xcode 6.4 image is the last (and only current) image to provide
# the macosx10.9 and macosx10.10 SDKs, which are supported by Qt 5.5.
osx_image: xcode6.4

compiler: clang

env:
  - MACOS_SDK=macosx10.9
  - MACOS_SDK=macosx10.10

before_install:
  - xcodebuild -showsdks

script:
  - ./build.sh

after_success:
  - otool -L build/qtbase/lib/QtNetwork.framework/QtNetwork

before_deploy:
  - ln -s build/qtbase/lib/QtNetwork.framework/QtNetwork QtNetwork-$MACOS_SDK

deploy:
  provider: releases
  api_key: $RELEASES_API_KEY
  file: QtNetwork-$MACOS_SDK
  skip_cleanup: true
  on:
    tags: true
